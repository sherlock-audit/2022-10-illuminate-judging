0xmuxyz

high

# Any external users can mint any amount of the Illuminate principal tokens due to lack of validations on mint() function in the Lender.sol

## Summary
- Any external users can `mint` any amount of the Illuminate principal tokens due to lack of validations on `mint()` function in the Lender.sol.

## Vulnerability Detail
- Lack of validations on `mint()` function that allow any external users to be able to mint any amount of the Illuminate principal tokens (Illuminate's ERC5095 tokens).

## Impact
- There is no validations such as `access control modifiers` on `mint()` function in the Lender.sol.
   - As a result, any external users can mint any amount of the Illuminate principal tokens (Illuminate's ERC5095 tokens) directly via calling `mint()` function directly. 
     - This lead to an exploit that give large fixed-rate positions to malicious attackers (attacker's wallet or attacker's contract) without lending proper amount of underlying tokens.

## Code Snippet
- This vulnerability is at the line of `mint()` function in the Lender.sol.
  - As we can see code snippet below, there is no validations such as access control modifiers on `mint()` function.
https://github.com/sherlock-audit/2022-10-illuminate/blob/main/src/Lender.sol#L270-L288
```solidity
    function mint(
        uint8 p,
        address u,
        uint256 m,
        uint256 a
    ) external unpaused(u, m, p) returns (bool) {
        // Fetch the desired principal token
        address principal = IMarketPlace(marketPlace).token(u, m, p);

        // Transfer the users principal tokens to the lender contract
        Safe.transferFrom(IERC20(principal), msg.sender, address(this), a);

        // Mint the tokens received from the user
        IERC5095(principalToken(u, m)).authMint(msg.sender, a);

        emit Mint(p, u, m, a);

        return true;
    }
```

## Tool used
- Manual Review in Foundry

## Recommendation
- Should implement the [Role-Based Access Control](https://docs.openzeppelin.com/contracts/4.x/access-control#role-based-access-control) in order to mitigate this vulnerability. 
   - For example, using the [Access Control module](https://docs.openzeppelin.com/contracts/4.x/access-control#using-access-control) provided by @openzeppelin/contracts is better to manage access rights of each users.
      - Using `onlyRole()` modifier and `hasRole()` function of @openzeppelin/contracts are useful in order to check whether a caller (msg.sender) of mint() function is the caller who has proper role or not. 
         https://docs.openzeppelin.com/contracts/4.x/access-control#using-access-control